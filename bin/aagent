#!/usr/bin/env python3

import sys
import os
from pyfiglet import Figlet
from azure.storage.queue import QueueClient, BinaryBase64DecodePolicy, BinaryBase64EncodePolicy

diff = os.getenv("INPUT_DIFF") 
if diff is None or not diff:
    print("diff is not set.")
    sys.exit(1)

connection_string = os.getenv("INPUT_CONNECTION_STRING")  
if connection_string is None or not connection_string:
    print("connection_string is not set.")
    sys.exit(1)

queue_name = os.getenv("INPUT_QUEUE_NAME") 
if queue_name is None or not queue_name:
    print("queue_name is not set.")
    sys.exit(1)

queue_client = QueueClient.from_connection_string(conn_str=connection_string, queue_name=queue_name,
                                                  message_encode_policy = BinaryBase64EncodePolicy(),
                                                  message_decode_policy = BinaryBase64DecodePolicy())

queue_client.send_message(diff.encode('utf8'))

f = Figlet(font='standard')  # Puedes cambiar a 'standard', 'block', etc.
print(f.renderText("Done !!!"))